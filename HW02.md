Question Paper:

1. In this problem we use the **OnlineNews** dataset available on Canvas. The dataset is about predicting the popularity of websites from 58 features. Discard the first two variables (url and timedelta) from the data. From the remaining variables use all but the last variable as predictors and the log of the last variable ($\ln(\text{shares})$) as the response.

Obtain all results using 5-fold cross-validation, which is computed as follows:

1. Generate a random permutation of the data. Use this random permutation to split the data into 5 disjoint subsets of almost equal size (7928 or 7929 observations each).
2. For each fold $i \in \{1,...,5\}$, train the model on all data except subset $i$ and test it on subset $i$, obtaining test error $\epsilon_{i}$.
3. Obtain the final test error as the average of the 5 test errors $\epsilon_{i}$.

Here the errors $\epsilon_{i}$ could be the MSE, or the $R^{2}$.

Report results for the following models:

a) **Null model.** Report the average train and test MSE of the null model that always predicts training $\overline{y}$ (average training $y$). (1 point)

b) **OLS regression** computed analytically by solving the following normal equations:

$$
(\frac{1}{N}X^{T}X+\lambda I_{p})\beta=\frac{1}{N}X^{T}Y
$$

where $\lambda \in \{0,10^{-5},10^{-4},10^{-3},10^{-2},10^{-1}\}$ and $N$ is the number of observations in $X$. Report in a table the average training and test $R^{2}$ and MSE, as well as their standard deviations obtained from the 5 folds. On the same graph, plot the average training and test MSE vs $\lambda$ as two separate curves. Also plot the average value of the logarithm of the determinant of $\frac{1}{N}X^{T}X+\lambda I_{p}$ (average obtained from the 5 folds) vs $\lambda$. (2 points)

c) **OLS regression with backward elimination** (e.g. using the SequentialFeatureSelector class from scikit-learn). For each number of features $k \in \{5,10,15,...,55\}$ report the average training and test $R^{2}$ and MSE in a table. On the same graph, plot the average training and test $R^{2}$ vs $k$ as two separate curves. (3 points)

d) **Random forest regression** with 100 trees and maximum depths 1, 2, .... up to 10. Report the average training, OOB, and test $R^{2}$ and MSE and their standard deviations in each case. On the same plot, plot the average training, OOB and test $R^{2}$ vs the maximum depth as three separate curves. How does the average OOB $R^{2}$ compare to the test $R^{2}$? (2 points)
